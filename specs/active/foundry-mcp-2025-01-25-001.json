{
  "spec_id": "foundry-mcp-2025-01-25-001",
  "title": "Foundry MCP Server",
  "generated": "2025-01-25T12:00:00Z",
  "last_updated": "2025-11-25T21:27:55.139087Z",
  "metadata": {
    "description": "Create Foundry MCP, a standalone MCP server for Spec-Driven Development published to PyPI. Extracts and refactors core business logic from claude-sdd-toolkit into an agent-agnostic MCP server.",
    "objectives": [
      "Create new PyPI package foundry-mcp with FastMCP 2.0",
      "Full parity with claude-sdd-toolkit CLI (~30 MCP tools)",
      "Include doc-query and run-tests functionality",
      "MCP resources for spec file access",
      "Workflow prompts for common tasks"
    ],
    "complexity": "high",
    "estimated_hours": 40,
    "repo_structure": {
      "src/foundry_mcp": "Python package root added to sys.path via hatch/uv",
      "src/foundry_mcp/core": "Shared logic for specs, tasks, validation, lifecycle, docs, testing",
      "src/foundry_mcp/tools": "FastMCP tool definitions mirroring claude-sdd-toolkit CLI",
      "src/foundry_mcp/resources": "MCP resource handlers for specs/templates/journals",
      "src/foundry_mcp/prompts": "Workflow prompt definitions consumed by MCP clients",
      "README.md & CHANGELOG.md": "Top-level docs updated every phase"
    },
    "dependency_notes": [
      "Extract spec/task/progress primitives from claude-sdd-toolkit common/ and sdd_next/ modules",
      "Port validation, journal, lifecycle helpers from sdd_validate/, sdd_update/, sdd_render/",
      "Reuse doc_query/ and run_tests/ discovery logic with agent-agnostic abstractions",
      "Ensure FastMCP 2.0 + hatch/uv build chain is configured before MCP tool wiring"
    ],
    "mcp_best_practices": [
      "Secure resources with workspace-scoped roots and optional API keys",
      "Version all MCP tool schemas and surface schema_version in responses",
      "Ship a machine-readable capabilities manifest for client discovery",
      "Implement MCP Notifications for reactive clients and Sampling for AI tasks",
      "Document API key provisioning (FOUNDRY_MCP_API_KEYS, tenant TOML overrides) and rotation expectations"
    ],
    "operational_practices": [
      "Centralized structured logging for every tool/resource invocation",
      "Metrics hooks for latency/success exported via standard logger",
      "Configuration file + env overrides to support multi-tenant hosting",
      "Server-side middleware enforces manifest rate limits and emits audit logs"
    ],
    "progress_percentage": 12,
    "status": "active",
    "current_phase": "phase-1"
  },
  "hierarchy": {
    "spec-root": {
      "type": "spec",
      "title": "Foundry MCP Server",
      "status": "in_progress",
      "parent": null,
      "children": [
        "phase-1",
        "phase-2",
        "phase-3",
        "phase-4",
        "phase-5",
        "phase-6"
      ],
      "total_tasks": 58,
      "completed_tasks": 7,
      "metadata": {},
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      }
    },
    "phase-1": {
      "type": "phase",
      "title": "Repository Setup & Core Infrastructure",
      "status": "in_progress",
      "parent": "spec-root",
      "children": [
        "phase-1-files",
        "phase-1-verify"
      ],
      "total_tasks": 11,
      "completed_tasks": 7,
      "metadata": {
        "purpose": "Establish the foundry-mcp repo structure, package configuration, and extract core spec CRUD operations",
        "risk_level": "low",
        "estimated_hours": 6,
        "repo_notes": "Follow top-level repo_structure for package layout and shared utilities"
      },
      "dependencies": {
        "blocks": [
          "phase-2",
          "phase-3",
          "phase-5"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "phase-1-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "in_progress",
      "parent": "phase-1",
      "children": [
        "task-1-1",
        "task-1-2",
        "task-1-3",
        "task-1-4",
        "task-1-5",
        "task-1-6",
        "task-1-7",
        "task-1-8",
        "task-1-9"
      ],
      "total_tasks": 9,
      "completed_tasks": 7,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-1-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-1-1": {
      "type": "task",
      "title": "pyproject.toml",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-1-2",
          "task-1-3",
          "task-1-8",
          "task-1-9"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "pyproject.toml",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "details": [
          "Create pyproject.toml with package name foundry-mcp",
          "Add FastMCP and MCP dependencies",
          "Configure hatchling build system",
          "Add foundry-mcp script entry point",
          "Set Python 3.10+ requirement"
        ],
        "started_at": "2025-11-25T21:12:29.616546Z",
        "status_note": "Creating pyproject.toml with foundry-mcp package configuration",
        "completed_at": "2025-11-25T21:14:32.367387Z",
        "needs_journaling": false,
        "actual_hours": 0.034,
        "journaled_at": "2025-11-25T21:14:32.371669Z"
      }
    },
    "task-1-2": {
      "type": "task",
      "title": "src/foundry_mcp/__init__.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "src/foundry_mcp/__init__.py",
        "task_category": "implementation",
        "estimated_hours": 0.25,
        "details": "Package init with version and public exports",
        "started_at": "2025-11-25T21:15:28.611166Z",
        "status_note": "Creating package init with version and public exports",
        "completed_at": "2025-11-25T21:15:59.536390Z",
        "needs_journaling": false,
        "actual_hours": 0.009,
        "journaled_at": "2025-11-25T21:15:59.540333Z"
      }
    },
    "task-1-3": {
      "type": "task",
      "title": "src/foundry_mcp/server.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-1-5",
          "task-1-6"
        ],
        "blocked_by": [
          "task-1-1",
          "task-1-8",
          "task-1-9"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "src/foundry_mcp/server.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": [
          "Create FastMCP server instance",
          "Import and register tool modules",
          "Create main() entry point",
          "Basic error handling"
        ],
        "started_at": "2025-11-25T21:27:09.301232Z",
        "status_note": "Creating FastMCP server with tool registration and main entry point",
        "completed_at": "2025-11-25T21:27:55.133473Z",
        "needs_journaling": false,
        "actual_hours": 0.013,
        "journaled_at": "2025-11-25T21:27:55.137477Z"
      }
    },
    "task-1-4": {
      "type": "task",
      "title": "src/foundry_mcp/core/spec.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-1-5"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "src/foundry_mcp/core/spec.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "details": [
          "Extract load_spec from claude-sdd-toolkit common/spec.py",
          "Extract save_spec with atomic write and backup",
          "Extract find_spec_path across status folders",
          "Extract list_specs with filtering",
          "Adapt to standalone package (remove external dependencies)"
        ],
        "started_at": "2025-11-25T21:17:03.790467Z",
        "status_note": "Creating core/spec.py with spec loading, saving, finding, and listing functions",
        "completed_at": "2025-11-25T21:21:39.496981Z",
        "needs_journaling": false,
        "actual_hours": 0.077,
        "journaled_at": "2025-11-25T21:21:39.502247Z"
      }
    },
    "task-1-5": {
      "type": "task",
      "title": "src/foundry_mcp/tools/queries.py",
      "status": "pending",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-3",
          "task-1-4",
          "task-1-9"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/queries.py",
        "task_category": "implementation",
        "estimated_hours": 1.5,
        "details": [
          "Implement foundry_find_specs MCP tool",
          "Implement foundry_list_specs MCP tool",
          "Add proper JSON schema for inputs/outputs",
          "Register tools with FastMCP server"
        ]
      }
    },
    "task-1-6": {
      "type": "task",
      "title": "README.md",
      "status": "pending",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-1-3"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "README.md",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "details": [
          "Project overview and tagline",
          "Installation instructions (pip, uvx)",
          "Claude Desktop configuration",
          "Basic usage examples"
        ]
      }
    },
    "task-1-7": {
      "type": "task",
      "title": "CHANGELOG.md entry",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "CHANGELOG.md",
        "estimated_hours": 0.25,
        "details": [
          "Create initial CHANGELOG.md with version 0.1.0 entry",
          "Record repository bootstrap decisions and tooling setup",
          "Define format for future phase updates"
        ],
        "started_at": "2025-11-25T21:22:48.847432Z",
        "status_note": "Creating initial CHANGELOG.md",
        "completed_at": "2025-11-25T21:23:36.973731Z",
        "needs_journaling": false,
        "actual_hours": 0.013,
        "journaled_at": "2025-11-25T21:23:36.978303Z"
      }
    },
    "task-1-8": {
      "type": "task",
      "title": "src/foundry_mcp/config.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-1-3",
          "task-1-9"
        ],
        "blocked_by": [
          "task-1-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "src/foundry_mcp/config.py",
        "task_category": "implementation",
        "estimated_hours": 0.75,
        "details": [
          "Define server configuration (workspace roots, journals path, log levels)",
          "Support env vars + TOML file overrides for multi-tenant hosting",
          "Implement optional API key requirement for tools/resources (FOUNDRY_MCP_API_KEYS, tenant-scoped secrets)",
          "Document rotation + revocation flow for API keys",
          "Provide helper to emit structured logging + metrics decorators"
        ],
        "started_at": "2025-11-25T21:24:01.962101Z",
        "status_note": "Creating config.py with server configuration, env vars, and API key support",
        "completed_at": "2025-11-25T21:25:01.965201Z",
        "needs_journaling": false,
        "actual_hours": 0.017,
        "journaled_at": "2025-11-25T21:25:01.969255Z"
      }
    },
    "task-1-9": {
      "type": "task",
      "title": "src/foundry_mcp/core/observability.py",
      "status": "completed",
      "parent": "phase-1-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-1-3",
          "task-1-5"
        ],
        "blocked_by": [
          "task-1-1",
          "task-1-8"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 1,
      "metadata": {
        "file_path": "src/foundry_mcp/core/observability.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": [
          "Implement structured logging decorators shared by all tools/resources",
          "Emit latency + status metrics to standard logger with tool/resource labels",
          "Add audit log helper for security events (auth, rate limit, resource access)",
          "Document how observability hooks integrate with FastMCP middleware"
        ],
        "started_at": "2025-11-25T21:25:31.155294Z",
        "status_note": "Creating observability.py with structured logging, metrics, and audit helpers",
        "completed_at": "2025-11-25T21:26:46.066436Z",
        "needs_journaling": false,
        "actual_hours": 0.021,
        "journaled_at": "2025-11-25T21:26:46.070834Z"
      }
    },
    "phase-1-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-1",
      "children": [
        "verify-1-1",
        "verify-1-2"
      ],
      "dependencies": {
        "blocked_by": [
          "phase-1-files"
        ],
        "blocks": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-1-1": {
      "type": "verify",
      "title": "Server starts without errors",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "uv run python -c \"from foundry_mcp.server import mcp; print('Server imported successfully')\"",
        "expected": "Server imports and initializes without errors",
        "runbook": [
          "Execute from repository root after running `uv pip install -e .`",
          "Command inserts src/ on PYTHONPATH via uv so imports work pre-PyPI"
        ]
      }
    },
    "verify-1-2": {
      "type": "verify",
      "title": "Core spec operations work",
      "status": "pending",
      "parent": "phase-1-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "cd foundry-mcp && python -m pytest tests/unit/test_core/test_spec.py -v",
        "expected": "All spec CRUD tests pass"
      }
    },
    "phase-2": {
      "type": "phase",
      "title": "Task Operations (Discovery & Status)",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-2-files",
        "phase-2-verify"
      ],
      "total_tasks": 10,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement the core task workflow - finding tasks, preparing context, updating status",
        "risk_level": "medium",
        "estimated_hours": 10,
        "parallelism_notes": "Task/progress extraction may start immediately after Phase 1 helpers land even if later phases remain blocked"
      },
      "dependencies": {
        "blocked_by": [
          "phase-1"
        ],
        "blocks": [
          "phase-4"
        ],
        "depends": []
      }
    },
    "phase-2-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-2",
      "children": [
        "task-2-1",
        "task-2-2",
        "task-2-3",
        "task-2-4",
        "task-2-5"
      ],
      "total_tasks": 8,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-2-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-2-1": {
      "type": "task",
      "title": "src/foundry_mcp/core/task.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [
        "task-2-1-1",
        "task-2-1-2",
        "task-2-1-3"
      ],
      "dependencies": {
        "blocks": [
          "task-2-3",
          "task-2-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/task.py",
        "task_category": "implementation",
        "estimated_hours": 4
      }
    },
    "task-2-1-1": {
      "type": "subtask",
      "title": "Extract get_next_task from sdd_next/discovery.py",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Find next actionable task based on status and dependencies"
      }
    },
    "task-2-1-2": {
      "type": "subtask",
      "title": "Extract prepare_task with context gathering",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Prepare task with full context including dependencies, file info, journal"
      }
    },
    "task-2-1-3": {
      "type": "subtask",
      "title": "Extract check_dependencies for dependency analysis",
      "status": "pending",
      "parent": "task-2-1",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Analyze task dependencies and blockers"
      }
    },
    "task-2-2": {
      "type": "task",
      "title": "src/foundry_mcp/core/progress.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [
        "task-2-2-1",
        "task-2-2-2"
      ],
      "dependencies": {
        "blocks": [
          "task-2-3"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/progress.py",
        "task_category": "implementation",
        "estimated_hours": 2
      }
    },
    "task-2-2-1": {
      "type": "subtask",
      "title": "Extract calculate_progress from common/progress.py",
      "status": "pending",
      "parent": "task-2-2",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Calculate progress percentages at all hierarchy levels"
      }
    },
    "task-2-2-2": {
      "type": "subtask",
      "title": "Extract recalculate_parent_status",
      "status": "pending",
      "parent": "task-2-2",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Propagate status changes up the hierarchy"
      }
    },
    "task-2-3": {
      "type": "task",
      "title": "src/foundry_mcp/tools/tasks.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-2-1",
          "task-2-2"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/tasks.py",
        "task_category": "implementation",
        "estimated_hours": 3,
        "details": [
          "Implement foundry_prepare_task MCP tool",
          "Implement foundry_next_task MCP tool",
          "Implement foundry_task_info MCP tool",
          "Implement foundry_check_deps MCP tool",
          "Implement foundry_update_status MCP tool",
          "Implement foundry_complete_task MCP tool",
          "Implement foundry_start_task MCP tool",
          "Implement foundry_progress MCP tool"
        ]
      }
    },
    "task-2-4": {
      "type": "task",
      "title": "tests/unit/test_core/test_task.py",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-2-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "tests/unit/test_core/test_task.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": "Unit tests for task discovery, status updates, and progress calculation"
      }
    },
    "task-2-5": {
      "type": "task",
      "title": "CHANGELOG.md (Phase 2)",
      "status": "pending",
      "parent": "phase-2-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "CHANGELOG.md",
        "estimated_hours": 0.25,
        "details": [
          "Capture task workflow extraction milestones",
          "Document new MCP task tools and schemas",
          "Link to any breaking changes for clients"
        ]
      }
    },
    "phase-2-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-2",
      "children": [
        "verify-2-1",
        "verify-2-2"
      ],
      "dependencies": {
        "blocked_by": [
          "phase-2-files"
        ],
        "blocks": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-2-1": {
      "type": "verify",
      "title": "Task tools respond correctly",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "cd foundry-mcp && python -m pytest tests/unit/test_core/test_task.py -v",
        "expected": "All task operation tests pass"
      }
    },
    "verify-2-2": {
      "type": "verify",
      "title": "MCP tools are registered and callable",
      "status": "pending",
      "parent": "phase-2-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "MCP inspector shows all task tools registered with correct schemas",
        "command": "",
        "runbook": [
          "Launch Foundry MCP with `uv run foundry-mcp --inspect`",
          "Open MCP Inspector and expand foundry_task* tools",
          "Confirm schemas align with spec inputs/outputs and tools respond"
        ]
      },
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      }
    },
    "phase-3": {
      "type": "phase",
      "title": "Validation & Journaling",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-3-files",
        "phase-3-verify"
      ],
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement spec validation, auto-fixing, and journal/blocker management",
        "risk_level": "medium",
        "estimated_hours": 6
      },
      "dependencies": {
        "blocked_by": [
          "phase-1"
        ],
        "blocks": [
          "phase-4"
        ],
        "depends": []
      }
    },
    "phase-3-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-3",
      "children": [
        "task-3-1",
        "task-3-2",
        "task-3-3",
        "task-3-4",
        "task-3-5"
      ],
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-3-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-3-1": {
      "type": "task",
      "title": "src/foundry_mcp/core/validation.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-3-3"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/validation.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "details": [
          "Extract validate_spec from sdd_validate/",
          "Extract get_fix_actions for auto-fix suggestions",
          "Extract apply_fixes for applying fixes",
          "Extract calculate_stats for spec statistics",
          "Emit structured diagnostics (code, message, suggested_fix) for MCP consumption"
        ]
      }
    },
    "task-3-2": {
      "type": "task",
      "title": "src/foundry_mcp/core/journal.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-3-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/journal.py",
        "task_category": "implementation",
        "estimated_hours": 1.5,
        "details": [
          "Extract add_journal_entry from sdd_update/journal.py",
          "Extract mark_blocked and unblock from sdd_update/status.py",
          "Handle blocker metadata and timestamps",
          "Define on-disk journal layout (status folders + journal.json NDJSON) shared with resources"
        ]
      }
    },
    "task-3-3": {
      "type": "task",
      "title": "src/foundry_mcp/tools/validation.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-3-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/validation.py",
        "task_category": "implementation",
        "estimated_hours": 1.5,
        "details": [
          "Implement foundry_validate_spec MCP tool",
          "Implement foundry_fix_spec MCP tool",
          "Implement foundry_stats MCP tool",
          "Return structured diagnostics + stats payload compatible with Phase 6 resources"
        ]
      }
    },
    "task-3-4": {
      "type": "task",
      "title": "src/foundry_mcp/tools/journal.py",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-3-2"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/journal.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": [
          "Implement foundry_add_journal MCP tool",
          "Implement foundry_mark_blocked MCP tool",
          "Implement foundry_unblock MCP tool"
        ]
      }
    },
    "task-3-5": {
      "type": "task",
      "title": "CHANGELOG.md (Phase 3)",
      "status": "pending",
      "parent": "phase-3-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "CHANGELOG.md",
        "estimated_hours": 0.25,
        "details": [
          "Document validation/journal schema changes",
          "Capture new MCP tools and structured error outputs",
          "Link to any migration notes for existing specs"
        ]
      }
    },
    "phase-3-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-3",
      "children": [
        "verify-3-1",
        "verify-3-2"
      ],
      "dependencies": {
        "blocked_by": [
          "phase-3-files"
        ],
        "blocks": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-3-1": {
      "type": "verify",
      "title": "Validation detects spec issues",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "cd foundry-mcp && python -m pytest tests/unit/test_core/test_validation.py -v",
        "expected": "Validation correctly identifies and can fix common spec issues"
      }
    },
    "verify-3-2": {
      "type": "verify",
      "title": "Journal entries are persisted correctly",
      "status": "pending",
      "parent": "phase-3-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "cd foundry-mcp && python -m pytest tests/unit/test_core/test_journal.py -v",
        "expected": "Journal entries are added, blockers are tracked"
      }
    },
    "phase-4": {
      "type": "phase",
      "title": "Planning, Lifecycle & Rendering",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-4-files",
        "phase-4-verify"
      ],
      "total_tasks": 9,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Implement spec creation, lifecycle management, and markdown rendering",
        "risk_level": "low",
        "estimated_hours": 5
      },
      "dependencies": {
        "blocked_by": [
          "phase-2",
          "phase-3"
        ],
        "blocks": [
          "phase-6"
        ],
        "depends": []
      }
    },
    "phase-4-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-4",
      "children": [
        "task-4-1",
        "task-4-2",
        "task-4-3",
        "task-4-4",
        "task-4-5"
      ],
      "total_tasks": 6,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-4-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-4-1": {
      "type": "task",
      "title": "src/foundry_mcp/core/rendering.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-4-3"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/rendering.py",
        "task_category": "implementation",
        "estimated_hours": 1.5,
        "details": [
          "Extract render_spec_to_markdown from sdd_render/renderer.py",
          "Support basic and enhanced rendering modes",
          "Generate progress visualization with status icons"
        ]
      }
    },
    "task-4-2": {
      "type": "task",
      "title": "src/foundry_mcp/core/lifecycle.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [
        "task-4-2-1",
        "task-4-2-2"
      ],
      "dependencies": {
        "blocks": [
          "task-4-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/lifecycle.py",
        "task_category": "implementation",
        "estimated_hours": 1.5
      }
    },
    "task-4-2-1": {
      "type": "subtask",
      "title": "Implement move_spec between status folders",
      "status": "pending",
      "parent": "task-4-2",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Move specs between pending/active/completed/archived"
      }
    },
    "task-4-2-2": {
      "type": "subtask",
      "title": "Implement complete_spec and archive_spec",
      "status": "pending",
      "parent": "task-4-2",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "details": "Mark spec complete with timestamp, archive completed specs"
      }
    },
    "task-4-3": {
      "type": "task",
      "title": "src/foundry_mcp/tools/rendering.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-4-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/rendering.py",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "details": "Implement foundry_render_spec MCP tool"
      }
    },
    "task-4-4": {
      "type": "task",
      "title": "src/foundry_mcp/tools/lifecycle.py",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-4-2"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/lifecycle.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": [
          "Implement foundry_move_spec MCP tool",
          "Implement foundry_complete_spec MCP tool",
          "Implement foundry_archive_spec MCP tool",
          "Implement foundry_create_spec MCP tool",
          "Implement foundry_list_templates MCP tool"
        ]
      }
    },
    "task-4-5": {
      "type": "task",
      "title": "CHANGELOG.md (Phase 4)",
      "status": "pending",
      "parent": "phase-4-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "CHANGELOG.md",
        "estimated_hours": 0.25,
        "details": [
          "Describe rendering modes, lifecycle APIs, and template workflows",
          "Note introduction of MCP smoke tests",
          "Capture any schema updates for downstream consumers"
        ]
      }
    },
    "phase-4-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-4",
      "children": [
        "verify-4-1",
        "verify-4-2",
        "verify-4-3"
      ],
      "dependencies": {
        "blocked_by": [
          "phase-4-files"
        ],
        "blocks": [],
        "depends": []
      },
      "total_tasks": 3,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-4-1": {
      "type": "verify",
      "title": "Rendering produces valid markdown",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "cd foundry-mcp && python -m pytest tests/unit/test_core/test_rendering.py -v",
        "expected": "Rendered markdown is valid and contains all spec information"
      }
    },
    "verify-4-2": {
      "type": "verify",
      "title": "Lifecycle operations work correctly",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "cd foundry-mcp && python -m pytest tests/unit/test_core/test_lifecycle.py -v",
        "expected": "Specs move between folders correctly, completion timestamps added"
      }
    },
    "verify-4-3": {
      "type": "verify",
      "title": "MCP registration smoke test",
      "status": "pending",
      "parent": "phase-4-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "uv run python -m pytest tests/integration/test_mcp_smoke.py -v",
        "expected": "FastMCP server registers rendering/lifecycle tools without schema errors",
        "runbook": [
          "Run after rendering + lifecycle tools are wired",
          "Test ensures foundry_render_spec and lifecycle tools appear via FastMCP client registry"
        ]
      }
    },
    "phase-5": {
      "type": "phase",
      "title": "Documentation & Testing Tools",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-5-files",
        "phase-5-verify"
      ],
      "total_tasks": 7,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Add doc-query and run-tests functionality for full toolkit parity",
        "risk_level": "medium",
        "estimated_hours": 8,
        "scope_notes": "Doc/query + testing tools must work for Foundry repo and arbitrary user repos via request payload overrides"
      },
      "dependencies": {
        "blocked_by": [
          "phase-1"
        ],
        "blocks": [
          "phase-6"
        ],
        "depends": []
      }
    },
    "phase-5-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-5",
      "children": [
        "task-5-1",
        "task-5-2",
        "task-5-3",
        "task-5-4",
        "task-5-5"
      ],
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-5-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-5-1": {
      "type": "task",
      "title": "src/foundry_mcp/core/docs.py",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-5-3"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/docs.py",
        "task_category": "implementation",
        "estimated_hours": 3,
        "details": [
          "Extract documentation query functions from doc_query/",
          "Implement find_class, find_function",
          "Implement trace_calls for call graph",
          "Implement impact_analysis for change impact",
          "Support arbitrary repository roots via request payload (defaults to Foundry workspace)",
          "Include schema_version + compatibility metadata in every response"
        ]
      }
    },
    "task-5-2": {
      "type": "task",
      "title": "src/foundry_mcp/core/testing.py",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-5-4"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/testing.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "details": [
          "Extract pytest runner from run_tests/",
          "Implement run_tests with presets",
          "Implement discover_tests for test discovery",
          "Allow repo path overrides + selective test targets for arbitrary workspaces",
          "Attach schema_version + execution_id to every run result"
        ]
      }
    },
    "task-5-3": {
      "type": "task",
      "title": "src/foundry_mcp/tools/docs.py",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-5-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/docs.py",
        "task_category": "implementation",
        "estimated_hours": 1.5,
        "details": [
          "Implement foundry_find_class MCP tool",
          "Implement foundry_find_function MCP tool",
          "Implement foundry_trace_calls MCP tool",
          "Implement foundry_impact_analysis MCP tool",
          "Surface schema_version + auth requirement tags in tool metadata"
        ]
      }
    },
    "task-5-4": {
      "type": "task",
      "title": "src/foundry_mcp/tools/testing.py",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-5-2"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/tools/testing.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": [
          "Implement foundry_run_tests MCP tool",
          "Implement foundry_discover_tests MCP tool",
          "Add progress reporting for long-running tests",
          "Expose schema_version + auth scopes via MCP tool registry"
        ]
      }
    },
    "task-5-5": {
      "type": "task",
      "title": "CHANGELOG.md (Phase 5)",
      "status": "pending",
      "parent": "phase-5-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "CHANGELOG.md",
        "estimated_hours": 0.25,
        "details": [
          "Capture doc-query and run-tests capabilities",
          "Describe new MCP schemas + presets",
          "Reference manual QA steps for reproducibility"
        ]
      }
    },
    "phase-5-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-5",
      "children": [
        "verify-5-1",
        "verify-5-2"
      ],
      "dependencies": {
        "blocked_by": [
          "phase-5-files"
        ],
        "blocks": [],
        "depends": []
      },
      "total_tasks": 2,
      "completed_tasks": 0,
      "metadata": {}
    },
    "verify-5-1": {
      "type": "verify",
      "title": "Doc-query tools return results",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Documentation queries return expected class/function information",
        "command": "",
        "runbook": [
          "Start server with `uv run foundry-mcp --inspect` and open MCP Inspector",
          "Invoke foundry_find_class against src/foundry_mcp/core/spec.py",
          "Confirm response lists symbols + file paths for sample repo and for alternate repo override"
        ]
      },
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      }
    },
    "verify-5-2": {
      "type": "verify",
      "title": "Test runner executes correctly",
      "status": "pending",
      "parent": "phase-5-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "foundry_run_tests executes pytest and returns results",
        "command": "",
        "runbook": [
          "Invoke foundry_run_tests via MCP Inspector with preset=unit",
          "Verify streaming progress events + final summary payload",
          "Re-run with `repo_root` override pointing to sample fixture repo"
        ]
      },
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      }
    },
    "phase-6": {
      "type": "phase",
      "title": "MCP Resources, Prompts & Publishing",
      "status": "pending",
      "parent": "spec-root",
      "children": [
        "phase-6-files",
        "phase-6-verify"
      ],
      "total_tasks": 14,
      "completed_tasks": 0,
      "metadata": {
        "purpose": "Complete MCP primitives (resources, prompts), test, and publish to PyPI",
        "risk_level": "low",
        "estimated_hours": 5
      },
      "dependencies": {
        "blocked_by": [
          "phase-4",
          "phase-5"
        ],
        "blocks": [],
        "depends": []
      }
    },
    "phase-6-files": {
      "type": "group",
      "title": "File Modifications",
      "status": "pending",
      "parent": "phase-6",
      "children": [
        "task-6-1",
        "task-6-2",
        "task-6-3",
        "task-6-4",
        "task-6-5",
        "task-6-6",
        "task-6-7",
        "task-6-8",
        "task-6-9"
      ],
      "total_tasks": 9,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [
          "phase-6-verify"
        ],
        "blocked_by": [],
        "depends": []
      }
    },
    "task-6-1": {
      "type": "task",
      "title": "src/foundry_mcp/resources/specs.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-6-6",
          "task-6-7"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/resources/specs.py",
        "task_category": "implementation",
        "estimated_hours": 1.5,
        "details": [
          "Implement foundry://specs/ resource (list specs)",
          "Implement foundry://specs/{status}/{spec_id} resource",
          "Implement foundry://specs/{spec_id}/journal resource",
          "Implement foundry://templates/ resource",
          "Reuse Phase 1/3 storage contract (status folders + journal layout)",
          "Enforce workspace-root sandbox + optional API key check per request"
        ]
      }
    },
    "task-6-2": {
      "type": "task",
      "title": "src/foundry_mcp/prompts/workflows.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-6-7"
        ],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/prompts/workflows.py",
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": [
          "Implement start_feature prompt",
          "Implement debug_test prompt",
          "Implement complete_phase prompt"
        ]
      }
    },
    "task-6-3": {
      "type": "task",
      "title": "tests/integration/test_mcp_tools.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-6-4"
        ],
        "blocked_by": [
          "task-6-8"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "tests/integration/test_mcp_tools.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "details": [
          "Integration tests for MCP tool registration",
          "Test tool input/output schemas",
          "Test resource access",
          "Test prompt expansion"
        ]
      }
    },
    "task-6-4": {
      "type": "task",
      "title": "Finalize README and publish to PyPI",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-6-3",
          "task-6-8"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "task_category": "implementation",
        "estimated_hours": 1,
        "details": [
          "Roll Phase 1-5 CHANGELOG entries into a release summary",
          "Update README with full tool documentation",
          "Build and publish to PyPI with hatch",
          "Test installation with pip install foundry-mcp"
        ],
        "file_path": "task-6-4.md"
      }
    },
    "task-6-5": {
      "type": "task",
      "title": "CHANGELOG.md (Phase 6)",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "CHANGELOG.md",
        "estimated_hours": 0.25,
        "details": [
          "Capture MCP resources/prompts additions",
          "Document publication steps and version numbers",
          "Note manual verification results for release"
        ]
      }
    },
    "task-6-6": {
      "type": "task",
      "title": "mcp/capabilities_manifest.json",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-6-8"
        ],
        "blocked_by": [
          "task-6-1"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "mcp/capabilities_manifest.json",
        "task_category": "implementation",
        "estimated_hours": 0.5,
        "details": [
          "Emit machine-readable list of tools/resources/prompts with schema_version",
          "Include auth requirements + rate limits per capability",
          "Serve manifest over MCP discovery endpoint and ship with package"
        ]
      }
    },
    "task-6-7": {
      "type": "task",
      "title": "src/foundry_mcp/core/capabilities.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-6-8",
          "task-6-9",
          "verify-6-5"
        ],
        "blocked_by": [
          "task-6-1",
          "task-6-2"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/capabilities.py",
        "task_category": "implementation",
        "estimated_hours": 2,
        "details": [
          "Implement MCP Notifications for resource updates (foundry/specs/updated)",
          "Implement MCP Sampling for server-side AI requests (impact analysis)",
          "Update capabilities manifest with notification/sampling support"
        ]
      }
    },
    "task-6-8": {
      "type": "task",
      "title": "src/foundry_mcp/core/rate_limit.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "task-6-3",
          "task-6-4",
          "task-6-9",
          "verify-6-5"
        ],
        "blocked_by": [
          "task-6-6",
          "task-6-7"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "src/foundry_mcp/core/rate_limit.py",
        "task_category": "implementation",
        "estimated_hours": 1.25,
        "details": [
          "Implement FastMCP middleware enforcing per-tool rate limits declared in manifest",
          "Expose config knobs for burst/steady limits per tenant via TOML + env",
          "Emit structured audit logs when throttling or auth failures occur",
          "Feed rate limit counters into observability helpers"
        ]
      }
    },
    "task-6-9": {
      "type": "task",
      "title": "tests/integration/test_notifications_sampling.py",
      "status": "pending",
      "parent": "phase-6-files",
      "children": [],
      "dependencies": {
        "blocks": [
          "verify-6-5"
        ],
        "blocked_by": [
          "task-6-7",
          "task-6-8"
        ],
        "depends": []
      },
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "file_path": "tests/integration/test_notifications_sampling.py",
        "task_category": "implementation",
        "estimated_hours": 1.5,
        "details": [
          "Add integration coverage for notification emission on spec/resource changes",
          "Validate MCP Sampling requests execute server-side impact analysis",
          "Assert rate limit middleware surfaces throttling events via FastMCP client",
          "Share fixtures with existing integration suite"
        ]
      }
    },
    "phase-6-verify": {
      "type": "group",
      "title": "Verification",
      "status": "pending",
      "parent": "phase-6",
      "children": [
        "verify-6-1",
        "verify-6-2",
        "verify-6-3",
        "verify-6-4",
        "verify-6-5"
      ],
      "total_tasks": 5,
      "completed_tasks": 0,
      "metadata": {},
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "phase-6-files"
        ],
        "depends": []
      }
    },
    "verify-6-1": {
      "type": "verify",
      "title": "All integration tests pass",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "uv run python -m pytest tests/integration/ -v",
        "expected": "All MCP integration tests pass"
      }
    },
    "verify-6-2": {
      "type": "verify",
      "title": "Claude Desktop integration works",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "Foundry MCP server starts in Claude Desktop, tools are visible and callable",
        "command": "",
        "runbook": [
          "Install package locally (pip install -e . or PyPI build)",
          "Add foundry-mcp server entry to Claude Desktop settings",
          "Launch Claude Desktop, open MCP Inspector, trigger sample tool"
        ]
      },
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      }
    },
    "verify-6-3": {
      "type": "verify",
      "title": "Package installs from PyPI",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "manual",
        "expected": "pip install foundry-mcp works, foundry-mcp command starts server",
        "command": "",
        "runbook": [
          "Create clean virtual environment",
          "Run `pip install foundry-mcp` from PyPI",
          "Execute `foundry-mcp --help` and `foundry-mcp --inspect` to confirm server starts"
        ]
      },
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      }
    },
    "verify-6-4": {
      "type": "verify",
      "title": "Capabilities manifest is current",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "uv run python scripts/validate_capabilities_manifest.py",
        "expected": "Manifest lists all tools/resources/prompts with matching schema_version",
        "runbook": [
          "Script cross-checks FastMCP registry to ensure manifest sync",
          "Fails if auth requirements or rate limits are missing"
        ]
      },
      "dependencies": {
        "blocks": [],
        "blocked_by": [],
        "depends": []
      }
    },
    "verify-6-5": {
      "type": "verify",
      "title": "Notifications, sampling, and rate limits",
      "status": "pending",
      "parent": "phase-6-verify",
      "children": [],
      "total_tasks": 1,
      "completed_tasks": 0,
      "metadata": {
        "verification_type": "auto",
        "command": "uv run python -m pytest tests/integration/test_notifications_sampling.py -v",
        "expected": "Notifications emit on spec changes, sampling requests execute, and throttling surfaces structured errors",
        "runbook": [
          "Run after capabilities + rate limit middleware are wired",
          "Test asserts FastMCP client receives notification events, sampling responses, and throttling telemetry"
        ]
      },
      "dependencies": {
        "blocks": [],
        "blocked_by": [
          "task-6-7",
          "task-6-8",
          "task-6-9"
        ],
        "depends": []
      }
    }
  },
  "journal": [
    {
      "timestamp": "2025-11-25T21:14:32.371662Z",
      "entry_type": "status_change",
      "title": "Task Completed: pyproject.toml",
      "author": "claude-code",
      "content": "Created pyproject.toml with foundry-mcp package configuration including: hatchling build system, fastmcp and mcp dependencies, foundry-mcp script entry point pointing to foundry_mcp.server:main, Python 3.10+ requirement, MIT license, and proper package metadata. File created at pyproject.toml.",
      "metadata": {},
      "task_id": "task-1-1"
    },
    {
      "timestamp": "2025-11-25T21:15:59.540324Z",
      "entry_type": "status_change",
      "title": "Task Completed: src/foundry_mcp/__init__.py",
      "author": "claude-code",
      "content": "Created src/foundry_mcp/__init__.py with package version 0.1.0, imports for create_server and main from server module, and __all__ exports list. Created necessary directory structure src/foundry_mcp/.",
      "metadata": {},
      "task_id": "task-1-2"
    },
    {
      "timestamp": "2025-11-25T21:21:39.502241Z",
      "entry_type": "status_change",
      "title": "Task Completed: src/foundry_mcp/core/spec.py",
      "author": "claude-code",
      "content": "Created src/foundry_mcp/core/spec.py with standalone implementations extracted from claude-sdd-toolkit: load_spec, save_spec (with atomic write and backup), find_spec_file, find_specs_directory, resolve_spec_file, list_specs, get_node, update_node, backup_spec. Also created core/__init__.py with public exports. All functions adapted to work standalone without external dependencies.",
      "metadata": {},
      "task_id": "task-1-4"
    },
    {
      "timestamp": "2025-11-25T21:23:36.978294Z",
      "entry_type": "status_change",
      "title": "Task Completed: CHANGELOG.md entry",
      "author": "claude-code",
      "content": "Created CHANGELOG.md with initial 0.1.0 entry documenting project setup, core spec operations module, package structure, and technical decisions (extracted from claude-sdd-toolkit, atomic writes, automatic backups). Format follows Keep a Changelog specification.",
      "metadata": {},
      "task_id": "task-1-7"
    },
    {
      "timestamp": "2025-11-25T21:25:01.969249Z",
      "entry_type": "status_change",
      "title": "Task Completed: src/foundry_mcp/config.py",
      "author": "claude-code",
      "content": "Created src/foundry_mcp/config.py with: ServerConfig dataclass supporting env vars + TOML file overrides, workspace configuration (roots, specs_dir, journals_path), logging configuration with structured JSON output, API key authentication (validate_api_key, require_auth decorator), metrics decorators (log_call, timed), global config management (get_config, set_config). Documented API key rotation/revocation flow in module docstring.",
      "metadata": {},
      "task_id": "task-1-8"
    },
    {
      "timestamp": "2025-11-25T21:26:46.070825Z",
      "entry_type": "status_change",
      "title": "Task Completed: src/foundry_mcp/core/observability.py",
      "author": "claude-code",
      "content": "Created src/foundry_mcp/core/observability.py with: MetricsCollector class emitting structured metrics (counter, gauge, timer) with tool/resource labels, AuditLogger class for security events (auth, rate limit, resource access, tool invocation), mcp_tool and mcp_resource decorators for FastMCP handler observability, convenience functions (get_metrics, get_audit_logger, audit_log). Module docstring documents FastMCP middleware integration patterns.",
      "metadata": {},
      "task_id": "task-1-9"
    },
    {
      "timestamp": "2025-11-25T21:27:55.137472Z",
      "entry_type": "status_change",
      "title": "Task Completed: src/foundry_mcp/server.py",
      "author": "claude-code",
      "content": "Created src/foundry_mcp/server.py with: create_server() factory function, FastMCP server instance with config integration, registered tools (list_specs, get_spec, get_spec_hierarchy, get_task) with @mcp_tool observability decorators, registered resources (specs://list, specs://{spec_id}), main() entry point with error handling and audit logging.",
      "metadata": {},
      "task_id": "task-1-3"
    }
  ]
}