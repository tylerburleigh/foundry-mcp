# Foundry MCP Server

**Spec ID:** `foundry-mcp-2025-01-25-001`  
**Status:** pending (0/43 tasks, 0%)  
**Estimated Effort:** 40 hours  
**Complexity:** high  

Create Foundry MCP, a standalone MCP server for Spec-Driven Development published to PyPI. Extracts and refactors core business logic from claude-sdd-toolkit into an agent-agnostic MCP server.

## Objectives

- Create new PyPI package foundry-mcp with FastMCP 2.0
- Full parity with claude-sdd-toolkit CLI (~30 MCP tools)
- Include doc-query and run-tests functionality
- MCP resources for spec file access
- Workflow prompts for common tasks

## Repository Setup & Core Infrastructure (0/8 tasks, 0%)

**Purpose:** Establish the foundry-mcp repo structure, package configuration, and extract core spec CRUD operations  
**Risk Level:** low  
**Estimated Hours:** 6  


### File Modifications (0/6 tasks)

#### ⏳ pyproject.toml

**File:** `pyproject.toml`  
**Status:** pending  
**Estimated:** 0.5 hours  

**Details:**
- Create pyproject.toml with package name foundry-mcp
- Add FastMCP and MCP dependencies
- Configure hatchling build system
- Add foundry-mcp script entry point
- Set Python 3.10+ requirement

#### ⏳ src/foundry_mcp/__init__.py

**File:** `src/foundry_mcp/__init__.py`  
**Status:** pending  
**Estimated:** 0.25 hours  

**Details:** Package init with version and public exports

**Blocked by:** task-1-1

#### ⏳ src/foundry_mcp/server.py

**File:** `src/foundry_mcp/server.py`  
**Status:** pending  
**Estimated:** 1 hours  

**Details:**
- Create FastMCP server instance
- Import and register tool modules
- Create main() entry point
- Basic error handling

**Blocked by:** task-1-1

#### ⏳ src/foundry_mcp/core/spec.py

**File:** `src/foundry_mcp/core/spec.py`  
**Status:** pending  
**Estimated:** 2 hours  

**Details:**
- Extract load_spec from claude-sdd-toolkit common/spec.py
- Extract save_spec with atomic write and backup
- Extract find_spec_path across status folders
- Extract list_specs with filtering
- Adapt to standalone package (remove external dependencies)

#### ⏳ src/foundry_mcp/tools/queries.py

**File:** `src/foundry_mcp/tools/queries.py`  
**Status:** pending  
**Estimated:** 1.5 hours  

**Details:**
- Implement foundry_find_specs MCP tool
- Implement foundry_list_specs MCP tool
- Add proper JSON schema for inputs/outputs
- Register tools with FastMCP server

**Blocked by:** task-1-3, task-1-4

#### ⏳ README.md

**File:** `README.md`  
**Status:** pending  
**Estimated:** 0.5 hours  

**Details:**
- Project overview and tagline
- Installation instructions (pip, uvx)
- Claude Desktop configuration
- Basic usage examples

**Blocked by:** task-1-3


### Verification (0/2 tasks)

**Blocked by:** phase-1-files  

#### ⏳ Server starts without errors

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -c "from foundry_mcp.server import mcp; print('Server imported successfully')"
```

**Expected:** Server imports and initializes without errors

#### ⏳ Core spec operations work

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -m pytest tests/unit/test_core/test_spec.py -v
```

**Expected:** All spec CRUD tests pass


## Task Operations (Discovery & Status) (0/9 tasks, 0%)

**Purpose:** Implement the core task workflow - finding tasks, preparing context, updating status  
**Risk Level:** medium  
**Estimated Hours:** 10  

**Blocked by:** phase-1  

### File Modifications (0/7 tasks)

#### ⏳ src/foundry_mcp/core/task.py

**File:** `src/foundry_mcp/core/task.py`  
**Status:** pending  
**Estimated:** 4 hours  

##### ⏳ Extract get_next_task from sdd_next/discovery.py

**Status:** pending  

**Details:** Find next actionable task based on status and dependencies

##### ⏳ Extract prepare_task with context gathering

**Status:** pending  

**Details:** Prepare task with full context including dependencies, file info, journal

##### ⏳ Extract check_dependencies for dependency analysis

**Status:** pending  

**Details:** Analyze task dependencies and blockers

#### ⏳ src/foundry_mcp/core/progress.py

**File:** `src/foundry_mcp/core/progress.py`  
**Status:** pending  
**Estimated:** 2 hours  

##### ⏳ Extract calculate_progress from common/progress.py

**Status:** pending  

**Details:** Calculate progress percentages at all hierarchy levels

##### ⏳ Extract recalculate_parent_status

**Status:** pending  

**Details:** Propagate status changes up the hierarchy

#### ⏳ src/foundry_mcp/tools/tasks.py

**File:** `src/foundry_mcp/tools/tasks.py`  
**Status:** pending  
**Estimated:** 3 hours  

**Details:**
- Implement foundry_prepare_task MCP tool
- Implement foundry_next_task MCP tool
- Implement foundry_task_info MCP tool
- Implement foundry_check_deps MCP tool
- Implement foundry_update_status MCP tool
- Implement foundry_complete_task MCP tool
- Implement foundry_start_task MCP tool
- Implement foundry_progress MCP tool

**Blocked by:** task-2-1, task-2-2

#### ⏳ tests/unit/test_core/test_task.py

**File:** `tests/unit/test_core/test_task.py`  
**Status:** pending  
**Estimated:** 1 hours  

**Details:** Unit tests for task discovery, status updates, and progress calculation

**Blocked by:** task-2-1


### Verification (0/2 tasks)

**Blocked by:** phase-2-files  

#### ⏳ Task tools respond correctly

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -m pytest tests/unit/test_core/test_task.py -v
```

**Expected:** All task operation tests pass

#### ⏳ MCP tools are registered and callable

**Status:** pending  
**Type:** manual  

**Expected:** MCP inspector shows all task tools registered with correct schemas


## Validation & Journaling (0/6 tasks, 0%)

**Purpose:** Implement spec validation, auto-fixing, and journal/blocker management  
**Risk Level:** medium  
**Estimated Hours:** 6  

**Blocked by:** phase-1  

### File Modifications (0/4 tasks)

#### ⏳ src/foundry_mcp/core/validation.py

**File:** `src/foundry_mcp/core/validation.py`  
**Status:** pending  
**Estimated:** 2 hours  

**Details:**
- Extract validate_spec from sdd_validate/
- Extract get_fix_actions for auto-fix suggestions
- Extract apply_fixes for applying fixes
- Extract calculate_stats for spec statistics

#### ⏳ src/foundry_mcp/core/journal.py

**File:** `src/foundry_mcp/core/journal.py`  
**Status:** pending  
**Estimated:** 1.5 hours  

**Details:**
- Extract add_journal_entry from sdd_update/journal.py
- Extract mark_blocked and unblock from sdd_update/status.py
- Handle blocker metadata and timestamps

#### ⏳ src/foundry_mcp/tools/validation.py

**File:** `src/foundry_mcp/tools/validation.py`  
**Status:** pending  
**Estimated:** 1.5 hours  

**Details:**
- Implement foundry_validate_spec MCP tool
- Implement foundry_fix_spec MCP tool
- Implement foundry_stats MCP tool

**Blocked by:** task-3-1

#### ⏳ src/foundry_mcp/tools/journal.py

**File:** `src/foundry_mcp/tools/journal.py`  
**Status:** pending  
**Estimated:** 1 hours  

**Details:**
- Implement foundry_add_journal MCP tool
- Implement foundry_mark_blocked MCP tool
- Implement foundry_unblock MCP tool

**Blocked by:** task-3-2


### Verification (0/2 tasks)

**Blocked by:** phase-3-files  

#### ⏳ Validation detects spec issues

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -m pytest tests/unit/test_core/test_validation.py -v
```

**Expected:** Validation correctly identifies and can fix common spec issues

#### ⏳ Journal entries are persisted correctly

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -m pytest tests/unit/test_core/test_journal.py -v
```

**Expected:** Journal entries are added, blockers are tracked


## Planning, Lifecycle & Rendering (0/7 tasks, 0%)

**Purpose:** Implement spec creation, lifecycle management, and markdown rendering  
**Risk Level:** low  
**Estimated Hours:** 5  

**Blocked by:** phase-2, phase-3  

### File Modifications (0/5 tasks)

#### ⏳ src/foundry_mcp/core/rendering.py

**File:** `src/foundry_mcp/core/rendering.py`  
**Status:** pending  
**Estimated:** 1.5 hours  

**Details:**
- Extract render_spec_to_markdown from sdd_render/renderer.py
- Support basic and enhanced rendering modes
- Generate progress visualization with status icons

#### ⏳ src/foundry_mcp/core/lifecycle.py

**File:** `src/foundry_mcp/core/lifecycle.py`  
**Status:** pending  
**Estimated:** 1.5 hours  

##### ⏳ Implement move_spec between status folders

**Status:** pending  

**Details:** Move specs between pending/active/completed/archived

##### ⏳ Implement complete_spec and archive_spec

**Status:** pending  

**Details:** Mark spec complete with timestamp, archive completed specs

#### ⏳ src/foundry_mcp/tools/rendering.py

**File:** `src/foundry_mcp/tools/rendering.py`  
**Status:** pending  
**Estimated:** 0.5 hours  

**Details:** Implement foundry_render_spec MCP tool

**Blocked by:** task-4-1

#### ⏳ src/foundry_mcp/tools/lifecycle.py

**File:** `src/foundry_mcp/tools/lifecycle.py`  
**Status:** pending  
**Estimated:** 1 hours  

**Details:**
- Implement foundry_move_spec MCP tool
- Implement foundry_complete_spec MCP tool
- Implement foundry_archive_spec MCP tool
- Implement foundry_create_spec MCP tool
- Implement foundry_list_templates MCP tool

**Blocked by:** task-4-2


### Verification (0/2 tasks)

**Blocked by:** phase-4-files  

#### ⏳ Rendering produces valid markdown

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -m pytest tests/unit/test_core/test_rendering.py -v
```

**Expected:** Rendered markdown is valid and contains all spec information

#### ⏳ Lifecycle operations work correctly

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -m pytest tests/unit/test_core/test_lifecycle.py -v
```

**Expected:** Specs move between folders correctly, completion timestamps added


## Documentation & Testing Tools (0/6 tasks, 0%)

**Purpose:** Add doc-query and run-tests functionality for full toolkit parity  
**Risk Level:** medium  
**Estimated Hours:** 8  

**Blocked by:** phase-1  

### File Modifications (0/4 tasks)

#### ⏳ src/foundry_mcp/core/docs.py

**File:** `src/foundry_mcp/core/docs.py`  
**Status:** pending  
**Estimated:** 3 hours  

**Details:**
- Extract documentation query functions from doc_query/
- Implement find_class, find_function
- Implement trace_calls for call graph
- Implement impact_analysis for change impact

#### ⏳ src/foundry_mcp/core/testing.py

**File:** `src/foundry_mcp/core/testing.py`  
**Status:** pending  
**Estimated:** 2 hours  

**Details:**
- Extract pytest runner from run_tests/
- Implement run_tests with presets
- Implement discover_tests for test discovery

#### ⏳ src/foundry_mcp/tools/docs.py

**File:** `src/foundry_mcp/tools/docs.py`  
**Status:** pending  
**Estimated:** 1.5 hours  

**Details:**
- Implement foundry_find_class MCP tool
- Implement foundry_find_function MCP tool
- Implement foundry_trace_calls MCP tool
- Implement foundry_impact_analysis MCP tool

**Blocked by:** task-5-1

#### ⏳ src/foundry_mcp/tools/testing.py

**File:** `src/foundry_mcp/tools/testing.py`  
**Status:** pending  
**Estimated:** 1 hours  

**Details:**
- Implement foundry_run_tests MCP tool
- Implement foundry_discover_tests MCP tool
- Add progress reporting for long-running tests

**Blocked by:** task-5-2


### Verification (0/2 tasks)

**Blocked by:** phase-5-files  

#### ⏳ Doc-query tools return results

**Status:** pending  
**Type:** manual  

**Expected:** Documentation queries return expected class/function information

#### ⏳ Test runner executes correctly

**Status:** pending  
**Type:** manual  

**Expected:** foundry_run_tests executes pytest and returns results


## MCP Resources, Prompts & Publishing (0/7 tasks, 0%)

**Purpose:** Complete MCP primitives (resources, prompts), test, and publish to PyPI  
**Risk Level:** low  
**Estimated Hours:** 5  

**Blocked by:** phase-4, phase-5  

### File Modifications (0/4 tasks)

#### ⏳ src/foundry_mcp/resources/specs.py

**File:** `src/foundry_mcp/resources/specs.py`  
**Status:** pending  
**Estimated:** 1.5 hours  

**Details:**
- Implement foundry://specs/ resource (list specs)
- Implement foundry://specs/{status}/{spec_id} resource
- Implement foundry://specs/{spec_id}/journal resource
- Implement foundry://templates/ resource

#### ⏳ src/foundry_mcp/prompts/workflows.py

**File:** `src/foundry_mcp/prompts/workflows.py`  
**Status:** pending  
**Estimated:** 1 hours  

**Details:**
- Implement start_feature prompt
- Implement debug_test prompt
- Implement complete_phase prompt

#### ⏳ tests/integration/test_mcp_tools.py

**File:** `tests/integration/test_mcp_tools.py`  
**Status:** pending  
**Estimated:** 2 hours  

**Details:**
- Integration tests for MCP tool registration
- Test tool input/output schemas
- Test resource access
- Test prompt expansion

#### ⏳ Finalize README and publish to PyPI

**File:** `task-6-4.md`  
**Status:** pending  
**Estimated:** 1 hours  

**Details:**
- Update README with full tool documentation
- Add CHANGELOG.md
- Build and publish to PyPI with hatch
- Test installation with pip install foundry-mcp

**Blocked by:** task-6-3


### Verification (0/3 tasks)

**Blocked by:** phase-6-files  

#### ⏳ All integration tests pass

**Status:** pending  
**Type:** auto  

**Command:**
```bash
cd foundry-mcp && python -m pytest tests/integration/ -v
```

**Expected:** All MCP integration tests pass

#### ⏳ Claude Desktop integration works

**Status:** pending  
**Type:** manual  

**Expected:** Foundry MCP server starts in Claude Desktop, tools are visible and callable

#### ⏳ Package installs from PyPI

**Status:** pending  
**Type:** manual  

**Expected:** pip install foundry-mcp works, foundry-mcp command starts server
