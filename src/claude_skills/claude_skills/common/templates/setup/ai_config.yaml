# Centralized AI Model Consultation Configuration
#
# This file defines default AI tool settings for the SDD Toolkit. You can
# customise tools, model priorities, consensus rules, and per-skill overrides.
# Generated automatically during `sdd-setup`.
#
# Tip: You can override these defaults at run time with CLI flags such as
# `--model gemini=gemini-2.5-flash` or `--model cursor-agent=composer-2`.

tools:
  gemini:
    command: gemini
    enabled: true
  cursor-agent:
    command: cursor-agent
    enabled: true
  codex:
    command: codex
    enabled: false
  claude:
    command: claude
    enabled: true
  opencode:
    command: opencode
    enabled: true

models:
  gemini:
    priority:
      - pro
      - gemini-2.5-flash
  cursor-agent:
    priority:
      - composer-1
  codex:
    priority:
      - gpt-5.1-codex
  claude:
    priority:
      - sonnet
      - haiku
  opencode:
    priority:
      - openai/gpt-5.1-codex

# Tool/provider fallback priority (consulted in order if earlier tools fail)
tool_priority:
  default:
    - gemini
    - cursor-agent
    - codex
    - claude
    - opencode

# Fallback and retry configuration
fallback:
  enabled: true # Enable automatic fallback to next tool on failure
  max_retries_per_tool: 2 # Number of retries before moving to next tool
  retry_on_status: # Status codes that trigger retry (transient errors)
    - timeout
    - error
  skip_on_status: # Status codes that skip to next tool (permanent errors)
    - not_found
    - invalid_output
  retry_delay_seconds: 1 # Delay between retry attempts

# Consultation limits (per skill invocation)
consultation_limits:
  max_tools_per_run: 4 # Maximum number of unique tools/providers to consult per skill run
consultation:
  timeout_seconds: 600

run-tests:
  tool_priority:
    - gemini
    - cursor-agent
    - codex
    - claude
    - opencode
  models:
    gemini: pro
    cursor-agent: composer-1
    codex: gpt-5.1-codex
    claude: sonnet
    opencode: openai/gpt-5.1-codex
    # Contextual overrides: use specific models based on failure type
    #overrides:
    #  failure_type:
    #    assertion:
    #      gemini: pro
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: haiku
    #    timeout:
    #      gemini: gemini-2.5-flash
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: haiku

sdd-plan-review:
  tool_priority:
    - gemini
    - cursor-agent
    - codex
    - claude
    - opencode
  models:
    gemini: pro
    cursor-agent: composer-1
    codex: gpt-5.1-codex
    claude: sonnet
    opencode: openai/gpt-5.1-codex
    # Contextual overrides: use specific models based on review type
    #overrides:
    #  review_type:
    #    full:
    #      gemini: pro
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: sonnet
    #    quick:
    #      gemini: gemini-2.5-flash
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: haiku

sdd-render:
  tool_priority:
    - gemini
    - cursor-agent
    - codex
    - claude
    - opencode
  models:
    gemini: gemini-2.5-flash
    cursor-agent: composer-1
    codex: gpt-5.1-codex
    claude: haiku
    opencode: openai/gpt-5.1-codex
    # Contextual overrides: use specific models based on feature
    #overrides:
    #  feature:
    #    executive_summary:
    #      gemini: pro
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: haiku
    #    narrative:
    #      gemini: gemini-2.5-flash
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: haiku

sdd-fidelity-review:
  tool_priority:
    - gemini
    - cursor-agent
    - codex
    - claude
    - opencode
  models:
    gemini: pro
    cursor-agent: composer-1
    codex: gpt-5.1-codex
    claude: sonnet
    opencode: openai/gpt-5.1-codex

llm-doc-gen:
  tool_priority:
    - gemini
    - cursor-agent
    - codex
    - claude
    - opencode
  models:
    gemini: gemini-2.5-flash
    cursor-agent: composer-1
    codex: gpt-5.1-codex
    claude: haiku
    opencode: openai/gpt-5.1-codex
    # Contextual overrides: use specific models based on documentation type
    #overrides:
    #  doc_type:
    #    architecture:
    #      gemini: pro
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: sonnet
    #    tutorial:
    #      gemini: gemini-2.5-flash
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: haiku
    #    api:
    #      gemini: gemini-2.5-flash
    #      codex: gpt-5.1-codex
    #      cursor-agent: composer-1
    #      claude: haiku

# =============================================================================
# Multi-Agent Consensus Configuration (Shared across skills)
# =============================================================================
# Used by: run-tests, llm-doc-gen, sdd-plan-review, sdd-fidelity-review
#
# Configures parallel consultation of multiple AI models for complex scenarios.
# When enabled, the toolkit consults multiple models simultaneously and synthesizes
# their insights to produce more robust solutions.
#
# - agents: Priority-ordered list of AI tools to consult during consensus
# - models: Specific models to use for each agent during consensus consultation
# - auto_trigger: Rules for when to automatically trigger consensus (run-tests only)
#   - Controls which test failure types automatically invoke multi-agent consultation
#   - true = auto-trigger consensus, false = use single-agent by default
#
consensus:
  agents:
    - cursor-agent
    - gemini
    - codex
    - claude
    - opencode
  models:
    gemini: pro
    cursor-agent: composer-1
    codex: gpt-5.1-codex
    claude: sonnet
    opencode: openai/gpt-5.1-codex
  auto_trigger:
    default: false
    assertion: true
    exception: true
    fixture: true
    import: false
    timeout: true
    flaky: false
    multi-file: true
